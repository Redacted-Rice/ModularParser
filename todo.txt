Add some more functional test cases